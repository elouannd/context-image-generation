<div id="cig_settings" class="extension_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Context Image Generation üçå</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <!-- Auth Info -->
            <div class="flex-container flexFlowColumn">
                <small>
                    <i class="fa-solid fa-info-circle"></i>
                    Configure your API key in <b>AI Response ‚Üí Chat Completion Source</b>
                </small>
                <hr>
            </div>

            <!-- Provider Selection -->
            <div class="flex-container">
                <div class="flex1">
                    <label for="cig_provider">Provider</label>
                    <select id="cig_provider" class="cig-setting">
                        <option value="makersuite">Google AI Studio</option>
                        <option value="openrouter">OpenRouter</option>
                    </select>
                </div>
            </div>

            <!-- Model Selection -->
            <div class="flex-container">
                <div class="flex1">
                    <label for="cig_model">Model</label>
                    <select id="cig_model" class="cig-setting">
                        <!-- Populated dynamically based on provider -->
                    </select>
                </div>
            </div>

            <!-- Aspect Ratio & Image Size -->
            <div class="flex-container">
                <div class="flex1">
                    <label for="cig_aspect_ratio">Aspect Ratio</label>
                    <select id="cig_aspect_ratio" class="cig-setting">
                        <option value="1:1">1:1 (Square)</option>
                        <option value="3:4">3:4 (Portrait)</option>
                        <option value="4:3">4:3 (Landscape)</option>
                        <option value="9:16">9:16 (Tall)</option>
                        <option value="16:9">16:9 (Wide)</option>
                    </select>
                </div>
                <div class="flex1" id="cig_image_size_container">
                    <label for="cig_image_size" id="cig_image_size_label">Image Size</label>
                    <select id="cig_image_size" class="cig-setting">
                        <option value="">Default</option>
                        <option value="1K">1K</option>
                        <option value="2K">2K</option>
                        <option value="4K">4K</option>
                    </select>
                </div>
            </div>

            <!-- Message Depth -->
            <div class="flex-container">
                <div class="flex1">
                    <label for="cig_message_depth">
                        Message Depth
                        <small>(1-10 messages as context)</small>
                    </label>
                    <input type="number" id="cig_message_depth" class="cig-setting text_pole" min="1" max="10" value="1"
                        style="width: 80px;" />
                </div>
            </div>

            <!-- Reference Options -->
            <div class="flex-container flexFlowColumn">
                <label class="checkbox_label" title="Include user and character avatars as reference images">
                    <input type="checkbox" id="cig_use_avatars" class="cig-setting" />
                    <span>Use avatar references</span>
                </label>
                <label class="checkbox_label" title="Include character and persona descriptions in the prompt">
                    <input type="checkbox" id="cig_include_descriptions" class="cig-setting" />
                    <span>Include character descriptions</span>
                </label>
                <label class="checkbox_label" title="Use the last generated image as a style reference">
                    <input type="checkbox" id="cig_use_previous_image" class="cig-setting" />
                    <span>Use previous image as reference</span>
                </label>
            </div>

            <!-- System Instruction -->
            <div class="flex-container flexFlowColumn">
                <label for="cig_system_instruction">System Instruction</label>
                <textarea id="cig_system_instruction" class="cig-setting text_pole textarea_compact" rows="3"
                    placeholder="Instructions for the image generation model..."></textarea>
            </div>

            <hr>

            <!-- Generate Button -->
            <div class="flex-container">
                <div id="cig_generate_btn" class="menu_button menu_button_icon"
                    title="Generate image from last message">
                    <i class="fa-solid fa-image"></i>
                    <span>Generate Image</span>
                </div>
            </div>

            <!-- Output Preview -->
            <div id="cig_preview_container" class="flex-container flexFlowColumn" style="display: none;">
                <label>Generated Image</label>
                <img id="cig_preview_image" style="max-width: 100%; border-radius: 8px;" />
            </div>

            <hr>

            <!-- Gallery Section -->
            <div class="inline-drawer">
                <div class="inline-drawer-toggle inline-drawer-header">
                    <b>Gallery</b>
                    <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                </div>
                <div class="inline-drawer-content">
                    <div id="cig_gallery_container" class="cig_gallery"></div>
                    <div id="cig_gallery_empty" class="cig_gallery_empty">
                        <i class="fa-solid fa-images"></i>
                        <span>No images generated yet.</span>
                    </div>
                    <div class="flex-container">
                        <div id="cig_clear_gallery" class="menu_button menu_button_icon" title="Clear gallery">
                            <i class="fa-solid fa-trash"></i>
                            <span>Clear Gallery</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>